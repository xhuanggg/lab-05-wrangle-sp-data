rename(address_lq = address),
rename(longitude_lq = longitude),
rename(latitude_lq = latitude)
)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.dn, latitude.dn, longitude.lq, latitude.lq)
) %>%
group_by(address.dn) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr) %>%
rename(address_dn = address) %>%
rename(longitude_dn = longitude)
rename(latitude_dn = latitude)
lq_state <- laquinta %>%
filter(state == state_abbr)%>%
rename(address_lq = address) %>%
rename(longitude_lq = longitude) %>%
rename(latitude_lq = latitude)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.dn, latitude.dn, longitude.lq, latitude.lq)
) %>%
group_by(address.dn) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr) %>%
rename(address_dn = address) %>%
rename(longitude_dn = longitude)
rename(latitude_dn = latitude)
lq_state <- laquinta %>%
filter(state == state_abbr)%>%
rename(address_lq = address) %>%
rename(longitude_lq = longitude) %>%
rename(latitude_lq = latitude)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.dn, latitude.dn, longitude.lq, latitude.lq)
) %>%
group_by(address.dn) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
state_function_2("NY")
View(dennys)
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr) %>%
rename(address_dn = address)
lq_state <- laquinta %>%
filter(state == state_abbr)%>%
rename(address_lq = address)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.dn, latitude.dn, longitude.lq, latitude.lq)
) %>%
group_by(address.dn) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr) %>%
rename(address_dn = address)
lq_state <- laquinta %>%
filter(state == state_abbr)%>%
rename(address_lq = address)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.dn) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) #%>%
#group_by(address.x) %>%
#mutate(min_distance = min(distance)) %>%
#dplyr::select(state, min_distance)
#df <- rbind(df, dn_lq_state)
colnames(dn_lq_state)
}
state_function_2("NY")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
colnames(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) #%>%
#dplyr::select(state, min_distance)
#df <- rbind(df, dn_lq_state)
colnames(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
colnames(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
library(tidyverse)
library(dsbox)
states <- read_csv("data/states.csv")
data(dennys, package = "dsbox")
data(laquinta, package = "dsbox")
dn_ak <- dennys %>%
filter(state == "AK")
nrow(dn_ak)
lq_ak <- laquinta %>%
filter(state == "AK")
nrow(lq_ak)
dn_lq_ak <- full_join(dn_ak, lq_ak,
by = "state"
)
dn_lq_ak
glimpse(dn_lq_ak)
# Define a cool function that calculates the distance between any two points on the earth.
haversine <- function(long1, lat1, long2, lat2, round = 3) {
# convert to radians
long1 <- long1 * pi / 180
lat1 <- lat1 * pi / 180
long2 <- long2 * pi / 180
lat2 <- lat2 * pi / 180
R <- 6371 # Earth mean radius in km
a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
d <- R * 2 * asin(sqrt(a))
return(round(d, round)) # distance in km
}
dn_lq_ak <- dn_lq_ak %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
)
glimpse(dn_lq_ak)
dn_lq_ak <- dn_lq_ak %>%
group_by(address.x) %>%
mutate(min_distance = min(distance))
# Summary stats
psych::describe(dn_lq_ak$min_distance)
ggplot(data = dn_lq_ak, aes(x = min_distance)) +
geom_histogram()
state_function <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance))
psych::describe(dn_lq_state$min_distance)
ggplot(data = dn_lq_state, aes(x = min_distance)) +
geom_density()
}
state_function("NC")
state_function("TX")
state_function("NY")
library(tidyverse)
library(dsbox)
states <- read_csv("data/states.csv")
data(dennys, package = "dsbox")
data(laquinta, package = "dsbox")
dn_ak <- dennys %>%
filter(state == "AK")
nrow(dn_ak)
lq_ak <- laquinta %>%
filter(state == "AK")
nrow(lq_ak)
dn_lq_ak <- full_join(dn_ak, lq_ak,
by = "state"
)
dn_lq_ak
glimpse(dn_lq_ak)
# Define a cool function that calculates the distance between any two points on the earth.
haversine <- function(long1, lat1, long2, lat2, round = 3) {
# convert to radians
long1 <- long1 * pi / 180
lat1 <- lat1 * pi / 180
long2 <- long2 * pi / 180
lat2 <- lat2 * pi / 180
R <- 6371 # Earth mean radius in km
a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
d <- R * 2 * asin(sqrt(a))
return(round(d, round)) # distance in km
}
dn_lq_ak <- dn_lq_ak %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
)
glimpse(dn_lq_ak)
dn_lq_ak <- dn_lq_ak %>%
group_by(address.x) %>%
mutate(min_distance = min(distance))
# Summary stats
psych::describe(dn_lq_ak$min_distance)
ggplot(data = dn_lq_ak, aes(x = min_distance)) +
geom_histogram()
state_function <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance))
psych::describe(dn_lq_state$min_distance)
ggplot(data = dn_lq_state, aes(x = min_distance)) +
geom_density()
}
state_function("NC")
state_function("TX")
state_function("NY")
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
df <- rbind(df, dn_lq_state)
colnames(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
df <- rbind(df, dn_lq_state)
}
# Create an empty data frame
df <- data.frame(
state = character(),
min_distance = numeric()
)
# Create a list of states
states <- list("NY", "NV", "NM", "NJ", "NH", "NE", "ND", "NC")
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
return(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
df <- rbind(df, dn_lq_state)
}
# Define another state function
state_function_2 <- function(state_abbr){
dn_state <- dennys %>%
filter(state == state_abbr)
lq_state <- laquinta %>%
filter(state == state_abbr)
dn_lq_state <- full_join(dn_state, lq_state,
by = "state"
) %>%
dplyr::mutate(
distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y)
) %>%
group_by(address.x) %>%
mutate(min_distance = min(distance)) %>%
dplyr::select(state, min_distance)
return(dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
state_function_2(state)
df <- rbind(df, dn_lq_state)
}
# Loop over to calculate the min distances in the list of states
for (state in states){
dn_lq_state <- state_function_2(state)
df <- rbind(df, dn_lq_state)
}
View(dn_lq_state)
View(df)
library(ggridges)
View(df)
ggplot(df, aes(x = min_distance, group = state)) +
geom_ridgeline(fill = "lightblue")
ggplot(df, aes(x = min_distance, y = state)) +
geom_ridgeline(fill = "lightblue")
ggplot(df, aes(x = min_distance, y = state, height = height)) +
geom_ridgeline(fill = "lightblue")
ggplot(df, aes(x = min_distance, y = state)) +
geom_density_ridgeline(fill = "lightblue")
ggplot(df, aes(x = min_distance, y = state)) +
geom_density_ridges(fill = "lightblue")
